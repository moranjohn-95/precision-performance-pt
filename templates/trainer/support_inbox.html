{% extends "dashboard_base.html" %}

{% block sidebar_title %}Trainer Menu{% endblock %}
{% block sidebar_menu %}
{% include "trainer/_sidebar.html" %}
{% endblock %}

{% block page_eyebrow %}Trainer dashboard{% endblock %}
{% block page_title %}Support{% endblock %}

{% block dashboard_content %}

<section class="dashboard-card dashboard-card--wide">
    <header class="card-header">
        <h2 class="card-title">Support inbox</h2>
        <p class="card-subtitle">
            View and respond to support requests from your clients.
        </p>
    </header>

    <div class="dashboard-table-wrapper">
        <table class="dashboard-table support-table">
            <thead>
                <tr>
                    <th>Client</th>
                    <th>Subject</th>
                    <th>Status</th>
                    <th class="col-last-updated">Last updated</th>
                    <th class="action-cell">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for ticket in tickets %}
                <tr>
                    <td>{{ ticket.client.get_full_name|default:ticket.client.username }}</td>
                    <td>{{ ticket.subject }}</td>
                    <td>
                        <span
                            class="status-pill {% if ticket.status == 'open' %}status-pill--open{% elif ticket.status == 'waiting' %}status-pill--waiting{% elif ticket.status == 'closed' %}status-pill--closed{% endif %}"
                        >
                            {{ ticket.get_status_display }}
                        </span>
                    </td>
                    <td class="col-last-updated">{{ ticket.updated_at|date:"d M Y H:i" }}</td>
                    <td class="action-cell">
                        <a
                            class="text-link"
                            href="{% url 'accounts:trainer_support_ticket' ticket.id %}"
                        >
                            View
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">
                        No support tickets assigned to you yet.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>

{% endblock %}
