{% extends "dashboard_base.html" %}

{% block sidebar_title %}Trainer Menu{% endblock %}
{% block sidebar_menu %}
{% include "trainer/_sidebar.html" %}
{% endblock %}

{% block page_eyebrow %}Trainer dashboard{% endblock %}
{% block page_title %}My clients{% endblock %}

{% block dashboard_content %}

<div class="dashboard-card">
    <h2 class="dashboard-card__title">Clients from consultation requests</h2>
    <p class="dashboard-subtitle">
        Trainer: {{ request.user.get_full_name|default:request.user.username }}
    </p>
    <p class="dashboard-card__subtitle">
        One row per email address, based on the latest request for that client.
    </p>

    <div class="dashboard-table-wrapper">
        <table class="dashboard-table">
            <thead>
                <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Email</th>
                    <th scope="col">Goal</th>
                    <th scope="col">Coaching option</th>
                    <th scope="col">Last request</th>
                </tr>
            </thead>
            <tbody>
                {% for row in clients %}
                <tr>
                    <td>
                        {% if row.user_id %}
                            <a href="{% url 'accounts:trainer_client_detail' row.user_id %}">
                                {{ row.name }}
                            </a>
                        {% else %}
                            {{ row.name }}
                            <span class="tag tag-muted">No portal account yet</span>
                        {% endif %}
                    </td>
                    <td>{{ row.email }}</td>
                    <td>{{ row.goal }}</td>
                    <td>{{ row.coaching_option }}</td>
                    <td>{{ row.last_request_date|date:"d M Y" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="muted-text">
                        No clients are currently assigned to this trainer.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="dashboard-card dashboard-card--secondary">
    <h2 class="dashboard-card__title">Next steps (concept)</h2>
    <p>
        This area can later include quick links to client profiles, recent check-ins,
        and programme updates.
    </p>
</div>

{% endblock %}
