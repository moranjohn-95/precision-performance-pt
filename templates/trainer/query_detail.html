{% extends "dashboard_base.html" %}
{% load static %}

{% block sidebar_title %}Trainer Menu{% endblock %}

{% block sidebar_menu %}
    {# Trainer query detail: only status can be edited, no reassignment. #}
    {% include "trainer/_sidebar.html" %}
{% endblock %}

{% block page_eyebrow %}Trainer dashboard{% endblock %}
{% block page_title %}Query detail{% endblock %}
{% block page_subtitle %}
{# Subtitle removed to reduce clutter #}
{% endblock %}

{% block dashboard_content %}
<section class="page-actions">
    <a class="btn btn-secondary" href="{% url 'accounts:trainer_queries' %}">
        Back to queries
    </a>
</section>

<section class="dashboard-card dashboard-card--wide">
    <header class="card-header">
        <h2 class="card-title">Query summary</h2>
    </header>

    <div class="card-body">
        <div class="dashboard-table-wrapper">
            <table class="dashboard-table">
                <tbody>
                    <tr>
                        <th scope="row">Submitted</th>
                        <td>{{ query.created_at|date:"d M Y, H:i" }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Name</th>
                        <td>{{ query.first_name }} {{ query.last_name }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Email</th>
                        <td>{{ query.email }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Phone</th>
                        <td>{{ query.phone|default:"â€”" }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Coaching option</th>
                        <td>{{ query.get_coaching_option_display }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Preferred contact</th>
                        <td>{{ query.get_preferred_contact_method_display }}</td>
                    </tr>
                    <tr>
                        <th scope="row">Consent</th>
                        <td>{% if query.contact_consent %}Yes{% else %}No{% endif %}</td>
                    </tr>
                    <tr>
                        <th scope="row">Status</th>
                        <td>{{ query.get_status_display }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card-section">
            <h3>Message</h3>
            <div class="message-box">
                {{ query.message|linebreaksbr }}
            </div>
        </div>

        <form method="post" class="form">
            {% csrf_token %}
            <div class="form-row">
                <label for="status">Status</label>
                <select name="status" id="status">
                    {% for value, label in status_choices %}
                        <option value="{{ value }}"
                            {% if query.status == value %}selected{% endif %}>
                            {{ label }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-actions form-actions--spaced">
                <button type="submit" class="btn-secondary">Save</button>
            </div>
        </form>
    </div>
</section>
{% endblock %}
